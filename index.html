<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Gobgob DEX - Particules Popup</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: #f8f8f8;
      text-align: center;
      padding: 20px;
    }
    h1 {
      font-size: 3em;
    }
    input, button {
      padding: 10px;
      font-size: 1em;
      margin: 5px;
    }
    .card-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      margin-top: 30px;
    }
    .card {
      width: 120px;
      height: 190px;
      perspective: 1000px;
      cursor: pointer;
    }
    .card-inner {
      width: 100%;
      height: 100%;
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
    }
    #popup {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      visibility: hidden;
    }
    #popup.visible {
      visibility: visible;
    }
    .popup-card {
      position: relative;
      width: 300px;
      height: 450px;
      z-index: 2;
      box-shadow: 0 0 30px rgba(255, 255, 255, 0.4);
      border-radius: 10px;
      animation: pulse-glow 2s infinite;
    }
    .popup-card-inner {
      width: 100%;
      height: 100%;
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
      transition: transform 0.2s ease;
    }
    #particle-canvas {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100%;
      height: 100%;
      z-index: 1;
      pointer-events: none;
    }
    @keyframes pulse-glow {
      0%, 100% {
        box-shadow: 0 0 30px rgba(255, 255, 255, 0.4);
      }
      50% {
        box-shadow: 0 0 60px rgba(255, 255, 255, 0.8);
      }
    }
  </style>
</head>
<body>
  <h1>Gobgob DEX</h1>
  <div class="card-grid">
    <div class="card" onclick="showPopup(1, 'UR')">
      <div class="card-inner" style="background-image: url('img/1.png')"></div>
    </div>
  </div>

  <div id="popup" onclick="hidePopup()">
    <canvas id="particle-canvas"></canvas>
    <div class="popup-card">
      <div class="popup-card-inner" id="popup-inner"></div>
    </div>
  </div>

  <script>
    const popup = document.getElementById('popup');
    const popupInner = document.getElementById('popup-inner');
    const canvas = document.getElementById('particle-canvas');
    const ctx = canvas.getContext('2d');

    let particles = [];
    let animationFrameId;
    let currentRarity = 'UR';

    const rarityColors = {
      N: '#b285ff',
      HR: '#7fffaa',
      SR: '#ffda6b',
      SSR: '#ff944f',
      UR: '#c2e0ff'
    };

    function createParticles(color, count = 100) {
      for (let i = 0; i < count; i++) {
        const angle = Math.random() * 2 * Math.PI;
        const speed = Math.random() * 1.5 + 0.5;
        particles.push({
          x: canvas.width / 2,
          y: canvas.height / 2,
          vx: Math.cos(angle) * speed,
          vy: Math.sin(angle) * speed,
          alpha: 1,
          radius: Math.random() * 3 + 1,
          color,
          life: 1 + Math.random() * 2
        });
      }
    }

    function animateParticles() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      particles.forEach(p => {
        p.x += p.vx;
        p.y += p.vy;
        p.alpha -= 0.01;
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.radius, 0, 2 * Math.PI);
        ctx.fillStyle = `${p.color}${Math.floor(p.alpha * 255).toString(16).padStart(2, '0')}`;
        ctx.shadowColor = p.color;
        ctx.shadowBlur = 10;
        ctx.fill();
      });
      particles = particles.filter(p => p.alpha > 0);
      if (particles.length < 100) {
        createParticles(rarityColors[currentRarity]);
      }
      animationFrameId = requestAnimationFrame(animateParticles);
    }

    function showPopup(cardId, rarity) {
      popup.classList.add("visible");
      popupInner.style.backgroundImage = `url('img/${cardId}.png')`;
      canvas.width = popup.clientWidth;
      canvas.height = popup.clientHeight;
      currentRarity = rarity;
      particles = [];
      createParticles(rarityColors[rarity]);
      animateParticles();
    }

    function hidePopup() {
      popup.classList.remove("visible");
      cancelAnimationFrame(animationFrameId);
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      particles = [];
    }
  </script>
</body>
</html>
